<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Operators · DifferentiationInterface.jl</title><meta name="title" content="Operators · DifferentiationInterface.jl"/><meta property="og:title" content="Operators · DifferentiationInterface.jl"/><meta property="twitter:title" content="Operators · DifferentiationInterface.jl"/><meta name="description" content="Documentation for DifferentiationInterface.jl."/><meta property="og:description" content="Documentation for DifferentiationInterface.jl."/><meta property="twitter:description" content="Documentation for DifferentiationInterface.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="DifferentiationInterface.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">DifferentiationInterface.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorial1/">Basics</a></li><li><a class="tocitem" href="../tutorial2/">Sparsity</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li class="is-active"><a class="tocitem" href>Operators</a><ul class="internal"><li><a class="tocitem" href="#List-of-operators"><span>List of operators</span></a></li><li><a class="tocitem" href="#Variants"><span>Variants</span></a></li><li><a class="tocitem" href="#Mutation-and-signatures"><span>Mutation and signatures</span></a></li><li><a class="tocitem" href="#Operators-Preparation"><span>Preparation</span></a></li><li><a class="tocitem" href="#Second-order"><span>Second order</span></a></li><li><a class="tocitem" href="#Sparsity"><span>Sparsity</span></a></li><li><a class="tocitem" href="#Going-further"><span>Going further</span></a></li></ul></li><li><a class="tocitem" href="../backends/">Backends</a></li><li><a class="tocitem" href="../api/">API</a></li></ul></li><li><span class="tocitem">Advanced</span><ul><li><a class="tocitem" href="../preparation/">Preparation</a></li><li><a class="tocitem" href="../overloads/">Overloads</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Operators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gdalle/DifferentiationInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gdalle/DifferentiationInterface.jl/blob/main/DifferentiationInterface/docs/src/operators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Operators"><a class="docs-heading-anchor" href="#Operators">Operators</a><a id="Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Operators" title="Permalink"></a></h1><p>DifferentiationInterface.jl is based on two concepts: <strong>operators</strong> and <strong>backends</strong>. This page is about the former, check out <a href="../backends/#Backends">that page</a> to learn about the latter.</p><h2 id="List-of-operators"><a class="docs-heading-anchor" href="#List-of-operators">List of operators</a><a id="List-of-operators-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-operators" title="Permalink"></a></h2><p>Given a function <code>f(x) = y</code>, there are several differentiation operators available. The terminology depends on:</p><ul><li>the type and shape of the input <code>x</code></li><li>the type and shape of the output <code>y</code></li><li>the order of differentiation</li></ul><p>Below we list and describe all the operators we support.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>See the book <a href="https://arxiv.org/abs/2403.14606">The Elements of Differentiable Programming</a> for details on these concepts.</p></div></div><h3 id="High-level-operators"><a class="docs-heading-anchor" href="#High-level-operators">High-level operators</a><a id="High-level-operators-1"></a><a class="docs-heading-anchor-permalink" href="#High-level-operators" title="Permalink"></a></h3><p>These operators are computed using only the input <code>x</code>.</p><table><tr><th style="text-align: left">operator</th><th style="text-align: left">order</th><th style="text-align: left">input  <code>x</code></th><th style="text-align: left">output   <code>y</code></th><th style="text-align: left">operator result type</th><th style="text-align: left">operator result shape</th></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.derivative"><code>derivative</code></a></td><td style="text-align: left">1</td><td style="text-align: left"><code>Number</code></td><td style="text-align: left"><code>Number</code> or <code>AbstractArray</code></td><td style="text-align: left">same as <code>y</code></td><td style="text-align: left"><code>size(y)</code></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.second_derivative"><code>second_derivative</code></a></td><td style="text-align: left">2</td><td style="text-align: left"><code>Number</code></td><td style="text-align: left"><code>Number</code> or <code>AbstractArray</code></td><td style="text-align: left">same as <code>y</code></td><td style="text-align: left"><code>size(y)</code></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.gradient"><code>gradient</code></a></td><td style="text-align: left">1</td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>Number</code></td><td style="text-align: left">same as <code>x</code></td><td style="text-align: left"><code>size(x)</code></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.jacobian"><code>jacobian</code></a></td><td style="text-align: left">1</td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>AbstractMatrix</code></td><td style="text-align: left"><code>(length(y), length(x))</code></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.hessian"><code>hessian</code></a></td><td style="text-align: left">2</td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>Number</code></td><td style="text-align: left"><code>AbstractMatrix</code></td><td style="text-align: left"><code>(length(x), length(x))</code></td></tr></table><h3 id="Low-level-operators"><a class="docs-heading-anchor" href="#Low-level-operators">Low-level operators</a><a id="Low-level-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Low-level-operators" title="Permalink"></a></h3><p>These operators are computed using the input <code>x</code> and a &quot;seed&quot; <code>v</code>, which lives either</p><ul><li>in the same space as <code>x</code> (we call it <code>dx</code>)</li><li>or in the same space as <code>y</code> (we call it <code>dy</code>)</li></ul><table><tr><th style="text-align: left">operator</th><th style="text-align: left">order</th><th style="text-align: left">input  <code>x</code></th><th style="text-align: left">output   <code>y</code></th><th style="text-align: left">seed <code>v</code></th><th style="text-align: left">operator result type</th><th style="text-align: left">operator result shape</th></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.pushforward"><code>pushforward</code></a> (or JVP)</td><td style="text-align: left">1</td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>dx</code></td><td style="text-align: left">same as <code>y</code></td><td style="text-align: left"><code>size(y)</code></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.pullback"><code>pullback</code></a> (or VJP)</td><td style="text-align: left">1</td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"><code>dy</code></td><td style="text-align: left">same as <code>x</code></td><td style="text-align: left"><code>size(x)</code></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.hvp"><code>hvp</code></a></td><td style="text-align: left">2</td><td style="text-align: left"><code>AbstractArray</code></td><td style="text-align: left"><code>Number</code></td><td style="text-align: left"><code>dx</code></td><td style="text-align: left">same as <code>x</code></td><td style="text-align: left"><code>size(x)</code></td></tr></table><h2 id="Variants"><a class="docs-heading-anchor" href="#Variants">Variants</a><a id="Variants-1"></a><a class="docs-heading-anchor-permalink" href="#Variants" title="Permalink"></a></h2><p>Several variants of each operator are defined.</p><table><tr><th style="text-align: left">out-of-place</th><th style="text-align: left">in-place</th><th style="text-align: left">out-of-place + primal</th><th style="text-align: left">in-place + primal</th></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.derivative"><code>derivative</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.derivative!"><code>derivative!</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_derivative"><code>value_and_derivative</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_derivative!"><code>value_and_derivative!</code></a></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.second_derivative"><code>second_derivative</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.second_derivative!"><code>second_derivative!</code></a></td><td style="text-align: left">NA</td><td style="text-align: left">NA</td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.gradient"><code>gradient</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.gradient!"><code>gradient!</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_gradient"><code>value_and_gradient</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_gradient!"><code>value_and_gradient!</code></a></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.hessian"><code>hessian</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.hessian!"><code>hessian!</code></a></td><td style="text-align: left">NA</td><td style="text-align: left">NA</td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.jacobian"><code>jacobian</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.jacobian!"><code>jacobian!</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_jacobian"><code>value_and_jacobian</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_jacobian!"><code>value_and_jacobian!</code></a></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.pushforward"><code>pushforward</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.pushforward!"><code>pushforward!</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_pushforward"><code>value_and_pushforward</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_pushforward!"><code>value_and_pushforward!</code></a></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.pullback"><code>pullback</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.pullback!"><code>pullback!</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_pullback"><code>value_and_pullback</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.value_and_pullback!"><code>value_and_pullback!</code></a></td></tr><tr><td style="text-align: left"><a href="../api/#DifferentiationInterface.hvp"><code>hvp</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.hvp!"><code>hvp!</code></a></td><td style="text-align: left">NA</td><td style="text-align: left">NA</td></tr></table><h2 id="Mutation-and-signatures"><a class="docs-heading-anchor" href="#Mutation-and-signatures">Mutation and signatures</a><a id="Mutation-and-signatures-1"></a><a class="docs-heading-anchor-permalink" href="#Mutation-and-signatures" title="Permalink"></a></h2><p>We support two types of functions:</p><ul><li>one-argument functions <code>f(x) = y</code></li><li>two-argument functions <code>f!(y, x) = nothing</code></li></ul><p>The same operators are defined for both cases, but they have different signatures (they take different arguments):</p><table><tr><th style="text-align: left">signature</th><th style="text-align: left">out-of-place</th><th style="text-align: left">in-place</th></tr><tr><td style="text-align: left"><code>f(x)</code></td><td style="text-align: left"><code>operator(f,     backend, x, [v], [extras])</code></td><td style="text-align: left"><code>operator!(f,     result, backend, x, [v], [extras])</code></td></tr><tr><td style="text-align: left"><code>f!(y, x)</code></td><td style="text-align: left"><code>operator(f!, y, backend, x, [v], [extras])</code></td><td style="text-align: left"><code>operator!(f!, y, result, backend, x, [v], [extras])</code></td></tr></table><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The positional arguments between <code>f</code>/<code>f!</code> and <code>backend</code> are always mutated. This convention holds regardless of the bang <code>!</code> in the operator name. In particular, for two-argument functions <code>f!(y, x)</code>, every variant of every operator will mutate <code>y</code>.</p></div></div><h2 id="Operators-Preparation"><a class="docs-heading-anchor" href="#Operators-Preparation">Preparation</a><a id="Operators-Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Operators-Preparation" title="Permalink"></a></h2><h3 id="Principle"><a class="docs-heading-anchor" href="#Principle">Principle</a><a id="Principle-1"></a><a class="docs-heading-anchor-permalink" href="#Principle" title="Permalink"></a></h3><p>In many cases, AD can be accelerated if the function has been called at least once (e.g. to record a tape) or if some cache objects are provided. This preparation procedure is backend-specific, but we expose a common syntax to achieve it.</p><table><tr><th style="text-align: left">operator</th><th style="text-align: left">preparation function (different point)</th><th style="text-align: left">preparation function (same point)</th></tr><tr><td style="text-align: left"><code>derivative</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_derivative"><code>prepare_derivative</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>gradient</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_gradient"><code>prepare_gradient</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>jacobian</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_jacobian"><code>prepare_jacobian</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>second_derivative</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_second_derivative"><code>prepare_second_derivative</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>hessian</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_hessian"><code>prepare_hessian</code></a></td><td style="text-align: left">-</td></tr><tr><td style="text-align: left"><code>pushforward</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_pushforward"><code>prepare_pushforward</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_pushforward_same_point"><code>prepare_pushforward_same_point</code></a></td></tr><tr><td style="text-align: left"><code>pullback</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_pullback"><code>prepare_pullback</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_pullback_same_point"><code>prepare_pullback_same_point</code></a></td></tr><tr><td style="text-align: left"><code>hvp</code></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_hvp"><code>prepare_hvp</code></a></td><td style="text-align: left"><a href="../api/#DifferentiationInterface.prepare_hvp_same_point"><code>prepare_hvp_same_point</code></a></td></tr></table><p>In addition, the preparation syntax depends on the number of arguments accepted by the function.</p><table><tr><th style="text-align: left">signature</th><th style="text-align: left">preparation signature</th></tr><tr><td style="text-align: left"><code>f(x)</code></td><td style="text-align: left"><code>prepare_operator(f,     backend, x, [v])</code></td></tr><tr><td style="text-align: left"><code>f!(y, x)</code></td><td style="text-align: left"><code>prepare_operator(f!, y, backend, x, [v])</code></td></tr></table><p>Preparation creates an object called <code>extras</code> which contains the the necessary information to speed up an operator and its variants. The idea is that you prepare only once, which can be costly, but then call the operator several times while reusing the same <code>extras</code>.</p><pre><code class="language-julia hljs">operator(f, backend, x, [v])  # slow because it includes preparation
operator(f, backend, x, [v], extras)  # fast because it skips preparation</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The <code>extras</code> object is always mutated when given to an operator, even though it is the last argument. This convention holds regardless of the bang <code>!</code> in the operator name.</p></div></div><h3 id="Reusing-preparation"><a class="docs-heading-anchor" href="#Reusing-preparation">Reusing preparation</a><a id="Reusing-preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Reusing-preparation" title="Permalink"></a></h3><p>Deciding whether it is safe to reuse the results of preparation is not easy. Here are the general rules that we strive to implement:</p><table><tr><th style="text-align: left"></th><th style="text-align: left">different point</th><th style="text-align: left">same point</th></tr><tr><td style="text-align: left">the output <code>extras</code> of...</td><td style="text-align: left"><code>prepare_operator(f, b, x)</code></td><td style="text-align: left"><code>prepare_operator_same_point(f, b, x, v)</code></td></tr><tr><td style="text-align: left">can be used in...</td><td style="text-align: left"><code>operator(f, b, other_x, extras)</code></td><td style="text-align: left"><code>operator(f, b, x, other_v, extras)</code></td></tr><tr><td style="text-align: left">provided that...</td><td style="text-align: left"><code>other_x</code> has the same type and shape as <code>x</code></td><td style="text-align: left"><code>other_v</code> has the same type and shape as <code>v</code></td></tr></table><p>These rules hold for the majority of backends, but there are some exceptions: see <a href="../preparation/#Preparation">this page</a> to know more.</p><h2 id="Second-order"><a class="docs-heading-anchor" href="#Second-order">Second order</a><a id="Second-order-1"></a><a class="docs-heading-anchor-permalink" href="#Second-order" title="Permalink"></a></h2><p>For second-order operators, there are two options: use a single backend or combine two of them within the <a href="../api/#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> struct.</p><h3 id="Single-backend"><a class="docs-heading-anchor" href="#Single-backend">Single backend</a><a id="Single-backend-1"></a><a class="docs-heading-anchor-permalink" href="#Single-backend" title="Permalink"></a></h3><p>Some backends natively support a set of second-order operators (typically only the <a href="../api/#DifferentiationInterface.hessian"><code>hessian</code></a>). In that case, it can be advantageous to use the backend on its own. If the operator is not supported natively, we will fall back on <code>SecondOrder(backend, backend)</code> (see below).</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Whenever the fallback on <code>SecondOrder(backend, backend)</code> occurs, the results of any preparation will be discarded.</p></div></div><h3 id="Combining-backends"><a class="docs-heading-anchor" href="#Combining-backends">Combining backends</a><a id="Combining-backends-1"></a><a class="docs-heading-anchor-permalink" href="#Combining-backends" title="Permalink"></a></h3><p>In general, you can use <a href="../api/#DifferentiationInterface.SecondOrder"><code>SecondOrder</code></a> to combine different backends.</p><pre><code class="language-julia hljs">backend = SecondOrder(outer_backend, inner_backend)</code></pre><p>The inner backend will be called first, and the outer backend will differentiate the generated code.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>There are many possible backend combinations, a lot of which will fail. Usually, the most efficient approach for Hessians is forward-over-reverse, i.e. a forward-mode outer backend and a reverse-mode inner backend.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Preparation does not yet work for the inner differentiation step of a <code>SecondOrder</code>, only the outer differentiation is prepared.</p></div></div><h2 id="Sparsity"><a class="docs-heading-anchor" href="#Sparsity">Sparsity</a><a id="Sparsity-1"></a><a class="docs-heading-anchor-permalink" href="#Sparsity" title="Permalink"></a></h2><p>When computing sparse Jacobians or Hessians, it is possible to take advantage of their sparsity pattern to speed things up. For this to work, three ingredients are needed (read <a href="https://epubs.siam.org/doi/10.1137/S0036144504444711">this survey</a> to understand why):</p><ol><li>An underlying (dense) backend</li><li>A sparsity pattern detector like <a href="https://adrianhill.de/SparseConnectivityTracer.jl/stable/api/#SparseConnectivityTracer.TracerSparsityDetector"><code>TracerSparsityDetector</code></a> from <a href="https://github.com/adrhill/SparseConnectivityTracer.jl">SparseConnectivityTracer.jl</a></li><li>A coloring algorithm like <a href="https://gdalle.github.io/SparseMatrixColorings.jl/stable/api/#SparseMatrixColorings.GreedyColoringAlgorithm"><code>GreedyColoringAlgorithm</code></a> from <a href="https://github.com/gdalle/SparseMatrixColorings.jl">SparseMatrixColorings.jl</a></li></ol><p>These ingredients can be combined within the <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.AutoSparse"><code>AutoSparse</code></a> wrapper, which Differentiation.jl re-exports. Note that for sparse Hessians, you need to put the <code>SecondOrder</code> backend inside <code>AutoSparse</code>, and not the other way around.</p><p>The preparation step of <code>jacobian</code> or <code>hessian</code> with an <code>AutoSparse</code> backend can be long, because it needs to detect the sparsity pattern and color the resulting sparse matrix. But after preparation, the more zeros are present in the matrix, the greater the speedup will be compared to dense differentiation.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The result of preparation for an <code>AutoSparse</code> backend cannot be reused if the sparsity pattern changes.</p></div></div><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>The symbolic backends have built-in sparsity handling, so <code>AutoSparse(AutoSymbolics())</code> and <code>AutoSparse(AutoFastDifferentiation())</code> do not need additional configuration for pattern detection or coloring. However they still benefit from preparation.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>At the moment, <code>AutoSparse</code> backends can be used with operators other than <code>jacobian</code> and <code>hessian</code>. This possibility will be removed in the next breaking release.</p></div></div><h2 id="Going-further"><a class="docs-heading-anchor" href="#Going-further">Going further</a><a id="Going-further-1"></a><a class="docs-heading-anchor-permalink" href="#Going-further" title="Permalink"></a></h2><h3 id="Non-standard-types"><a class="docs-heading-anchor" href="#Non-standard-types">Non-standard types</a><a id="Non-standard-types-1"></a><a class="docs-heading-anchor-permalink" href="#Non-standard-types" title="Permalink"></a></h3><p>The package is thoroughly tested with inputs and outputs of the following types: <code>Float64</code>, <code>Vector{Float64}</code> and <code>Matrix{Float64}</code>. We also expect it to work on most kinds of <code>Number</code> and <code>AbstractArray</code> variables. Beyond that, you are in uncharted territory. We voluntarily keep the type annotations minimal, so that passing more complex objects or custom structs <em>might work with some backends</em>, but we make no guarantees about that.</p><h3 id="Multiple-inputs/outputs"><a class="docs-heading-anchor" href="#Multiple-inputs/outputs">Multiple inputs/outputs</a><a id="Multiple-inputs/outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-inputs/outputs" title="Permalink"></a></h3><p>Restricting the API to one input and one output has many coding advantages, but it is not very flexible. If you need more than that, use <a href="https://github.com/jonniedie/ComponentArrays.jl">ComponentArrays.jl</a> to wrap several objects inside a single <code>ComponentVector</code>.</p><h3 id="Batched-evaluation"><a class="docs-heading-anchor" href="#Batched-evaluation">Batched evaluation</a><a id="Batched-evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Batched-evaluation" title="Permalink"></a></h3><p>This is not supported at the moment, but we plan to allow several seeds at once in low-level operators (similar to the chunking in ForwardDiff.jl or the batches in Enzyme.jl).</p><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial2/">« Sparsity</a><a class="docs-footer-nextpage" href="../backends/">Backends »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Monday 27 May 2024 17:44">Monday 27 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
